<!DOCTYPE html>
<!-- saved from url=(0139)https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/tooluse_wBHWNY-uSdiNugYi6vHreQ/complete_google_forms_generator.html -->
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Forms Generator - Complete Version</title>
    <link href="./Google Forms Generator - Complete Version_files/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./Google Forms Generator - Complete Version_files/all.min.css">
    <script src="./Google Forms Generator - Complete Version_files/api.js"></script>
    <script src="./Google Forms Generator - Complete Version_files/client"></script><style id="googleidentityservice_button_styles">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-r4WDKb{height:42px;width:42px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}@media screen and (preferes-contrast:more){.nsm7Bb-HzV7m-LgbsSe{color:#000}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{color:#fff}}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:rgb(210,227,252);outline:none}.nsm7Bb-HzV7m-LgbsSe:focus-within{outline:2px solid #00639b;border-color:transparent}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.08)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff,.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#000;fill:#000}}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style></head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                <i class="fas fa-file-alt text-blue-600 mr-3"></i>
                Google Forms Generator
            </h1>
            <p class="text-gray-600 text-lg">질문을 입력하면 자동으로 구글폼을 생성해드립니다</p>
        </header>

        <!-- Login Status -->
        <div class="max-w-4xl mx-auto mb-8">
            <div id="loginStatus" class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <i class="fas fa-user-circle text-2xl text-gray-400 mr-3"></i>
                        <span id="userInfo" class="text-gray-600">로그인이 필요합니다</span>
                    </div>
                    <button id="loginButton" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-200">
                        <i class="fab fa-google mr-2"></i>
                        Google 로그인
                    </button>
                </div>
            </div>
        </div>

        <!-- API Configuration -->
        <div class="max-w-4xl mx-auto mb-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-cog text-blue-600 mr-2"></i>
                    API 설정
                </h2>
                
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Google Client ID</label>
                        <input type="text" id="clientId" placeholder="your-client-id.apps.googleusercontent.com" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Google API Key</label>
                        <input type="password" id="apiKey" placeholder="AIzaSy..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div class="flex gap-2">
                    <button id="saveConfig" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        <i class="fas fa-save mr-2"></i>
                        설정 저장
                    </button>
                    <button id="loadEnvVars" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        <i class="fas fa-cloud-download-alt mr-2"></i>
                        환경변수 로드
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Form -->
        <div class="max-w-4xl mx-auto">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-edit text-blue-600 mr-2"></i>
                    설문지 질문 입력
                </h2>

                <!-- Form Builder -->
                <div class="space-y-6">
                    <!-- Form Title and Description -->
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">설문지 제목</label>
                            <input type="text" id="formTitle" placeholder="예: 고객 만족도 조사" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">설문지 설명</label>
                            <input type="text" id="formDescription" placeholder="예: 서비스 개선을 위한 고객 의견 수집" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>

                    <!-- Questions Container -->
                    <div id="questionsContainer" class="space-y-4">
                        <!-- Initial Question -->
                        <div class="question-item bg-gray-50 p-4 rounded-lg border">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="font-medium text-gray-800">질문 1</h3>
                                <button class="remove-question text-red-600 hover:text-red-800" title="질문 삭제">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            
                            <div class="space-y-3">
                                <input type="text" class="question-title w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="질문을 입력하세요">
                                
                                <div class="flex gap-4">
                                    <select class="question-type px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="MULTIPLE_CHOICE">객관식</option>
                                        <option value="SHORT_ANSWER">단답형</option>
                                        <option value="PARAGRAPH">장문형</option>
                                        <option value="CHECKBOX">체크박스</option>
                                        <option value="DROPDOWN">드롭다운</option>
                                    </select>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" class="question-required mr-2">
                                        <span class="text-sm text-gray-700">필수 질문</span>
                                    </label>
                                </div>
                                
                                <div class="options-container">
                                    <div class="flex items-center mb-2">
                                        <span class="text-sm text-gray-600 mr-2">선택지:</span>
                                        <button class="add-option text-blue-600 hover:text-blue-800 text-sm">
                                            <i class="fas fa-plus mr-1"></i>선택지 추가
                                        </button>
                                    </div>
                                    <div class="options-list space-y-2">
                                        <div class="option-item flex items-center gap-2">
                                            <input type="text" class="option-text flex-1 px-2 py-1 border border-gray-300 rounded text-sm" placeholder="선택지 1">
                                            <button class="remove-option text-red-600 hover:text-red-800 text-sm">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                        <div class="option-item flex items-center gap-2">
                                            <input type="text" class="option-text flex-1 px-2 py-1 border border-gray-300 rounded text-sm" placeholder="선택지 2">
                                            <button class="remove-option text-red-600 hover:text-red-800 text-sm">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add Question Button -->
                    <button id="addQuestion" class="w-full bg-blue-100 hover:bg-blue-200 text-blue-700 font-semibold py-3 px-4 rounded-lg border-2 border-dashed border-blue-300 transition duration-200">
                        <i class="fas fa-plus mr-2"></i>
                        새 질문 추가
                    </button>

                    <!-- Generate Form Button -->
                    <div class="text-center pt-6">
                        <button id="generateForm" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform transition duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed" disabled="">
                            <i class="fas fa-magic mr-2"></i>
                            구글폼 생성하기
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generated Form Preview -->
        <div id="formPreview" class="max-w-4xl mx-auto mt-8 hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-eye text-green-600 mr-2"></i>
                    생성된 구글폼
                </h2>
                <div id="formResult" class="space-y-4">
                    <!-- Form result will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
            <p class="text-gray-700">구글폼을 생성하고 있습니다...</p>
        </div>
    </div>

    <script>
        // Global variables
        let isSignedIn = false;
        let currentUser = null;
        let questionCount = 1;

        // Configuration
        const CONFIG = {
            clientId: '',
            apiKey: '',
            discoveryDocs: ['https://forms.googleapis.com/$discovery/rest?version=v1'],
            scopes: 'https://www.googleapis.com/auth/forms.body https://www.googleapis.com/auth/forms.responses.readonly'
        };

        // Load environment variables
        function loadEnvironmentVariables() {
            // Try to load from process.env (Vercel environment variables)
            if (typeof process !== 'undefined' && process.env) {
                CONFIG.clientId = process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID || '';
                CONFIG.apiKey = process.env.NEXT_PUBLIC_GOOGLE_API_KEY || '';
            }
            
            // Also try to load from meta tags (if set by server)
            const clientIdMeta = document.querySelector('meta[name="google-client-id"]');
            const apiKeyMeta = document.querySelector('meta[name="google-api-key"]');
            
            if (clientIdMeta) CONFIG.clientId = clientIdMeta.content;
            if (apiKeyMeta) CONFIG.apiKey = apiKeyMeta.content;
            
            // Load from localStorage as fallback
            const savedClientId = localStorage.getItem('googleClientId');
            const savedApiKey = localStorage.getItem('googleApiKey');
            
            if (savedClientId) CONFIG.clientId = savedClientId;
            if (savedApiKey) CONFIG.apiKey = savedApiKey;
            
            // Update UI
            document.getElementById('clientId').value = CONFIG.clientId;
            document.getElementById('apiKey').value = CONFIG.apiKey;
            
            return CONFIG.clientId && CONFIG.apiKey;
        }

        // Initialize Google API
        async function initializeGapi() {
            try {
                await new Promise((resolve, reject) => {
                    gapi.load('auth2', resolve);
                });
                
                await gapi.auth2.init({
                    client_id: CONFIG.clientId
                });
                
                await gapi.load('client', async () => {
                    await gapi.client.init({
                        apiKey: CONFIG.apiKey,
                        clientId: CONFIG.clientId,
                        discoveryDocs: CONFIG.discoveryDocs,
                        scope: CONFIG.scopes
                    });
                });
                
                updateSignInStatus();
                return true;
            } catch (error) {
                console.error('Google API 초기화 실패:', error);
                showNotification('Google API 초기화에 실패했습니다. API 설정을 확인해주세요.', 'error');
                return false;
            }
        }

        // Update sign-in status
        function updateSignInStatus() {
            const authInstance = gapi.auth2.getAuthInstance();
            if (!authInstance) return;
            
            isSignedIn = authInstance.isSignedIn.get();
            currentUser = isSignedIn ? authInstance.currentUser.get() : null;
            
            const loginButton = document.getElementById('loginButton');
            const userInfo = document.getElementById('userInfo');
            const generateButton = document.getElementById('generateForm');
            
            if (isSignedIn && currentUser) {
                const profile = currentUser.getBasicProfile();
                userInfo.innerHTML = `
                    <div class="flex items-center">
                        <img src="${profile.getImageUrl()}" alt="Profile" class="w-8 h-8 rounded-full mr-2">
                        <span>${profile.getName()}</span>
                    </div>
                `;
                loginButton.innerHTML = '<i class="fas fa-sign-out-alt mr-2"></i>로그아웃';
                loginButton.onclick = signOut;
                generateButton.disabled = false;
            } else {
                userInfo.textContent = '로그인이 필요합니다';
                loginButton.innerHTML = '<i class="fab fa-google mr-2"></i>Google 로그인';
                loginButton.onclick = signIn;
                generateButton.disabled = true;
            }
        }

        // Sign in
        async function signIn() {
            try {
                const authInstance = gapi.auth2.getAuthInstance();
                await authInstance.signIn();
                updateSignInStatus();
                showNotification('로그인되었습니다!', 'success');
            } catch (error) {
                console.error('로그인 실패:', error);
                showNotification('로그인에 실패했습니다.', 'error');
            }
        }

        // Sign out
        async function signOut() {
            try {
                const authInstance = gapi.auth2.getAuthInstance();
                await authInstance.signOut();
                updateSignInStatus();
                showNotification('로그아웃되었습니다.', 'info');
            } catch (error) {
                console.error('로그아웃 실패:', error);
            }
        }

        // Save configuration
        function saveConfiguration() {
            const clientId = document.getElementById('clientId').value.trim();
            const apiKey = document.getElementById('apiKey').value.trim();
            
            if (!clientId || !apiKey) {
                showNotification('Client ID와 API Key를 모두 입력해주세요.', 'error');
                return;
            }
            
            CONFIG.clientId = clientId;
            CONFIG.apiKey = apiKey;
            
            localStorage.setItem('googleClientId', clientId);
            localStorage.setItem('googleApiKey', apiKey);
            
            showNotification('설정이 저장되었습니다. 페이지를 새로고침합니다.', 'success');
            
            setTimeout(() => {
                location.reload();
            }, 1500);
        }

        // Add question
        function addQuestion() {
            questionCount++;
            const questionsContainer = document.getElementById('questionsContainer');
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-item bg-gray-50 p-4 rounded-lg border';
            questionDiv.innerHTML = `
                <div class="flex items-center justify-between mb-3">
                    <h3 class="font-medium text-gray-800">질문 ${questionCount}</h3>
                    <button class="remove-question text-red-600 hover:text-red-800" title="질문 삭제">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <div class="space-y-3">
                    <input type="text" class="question-title w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           placeholder="질문을 입력하세요">
                    
                    <div class="flex gap-4">
                        <select class="question-type px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="MULTIPLE_CHOICE">객관식</option>
                            <option value="SHORT_ANSWER">단답형</option>
                            <option value="PARAGRAPH">장문형</option>
                            <option value="CHECKBOX">체크박스</option>
                            <option value="DROPDOWN">드롭다운</option>
                        </select>
                        
                        <label class="flex items-center">
                            <input type="checkbox" class="question-required mr-2">
                            <span class="text-sm text-gray-700">필수 질문</span>
                        </label>
                    </div>
                    
                    <div class="options-container">
                        <div class="flex items-center mb-2">
                            <span class="text-sm text-gray-600 mr-2">선택지:</span>
                            <button class="add-option text-blue-600 hover:text-blue-800 text-sm">
                                <i class="fas fa-plus mr-1"></i>선택지 추가
                            </button>
                        </div>
                        <div class="options-list space-y-2">
                            <div class="option-item flex items-center gap-2">
                                <input type="text" class="option-text flex-1 px-2 py-1 border border-gray-300 rounded text-sm" placeholder="선택지 1">
                                <button class="remove-option text-red-600 hover:text-red-800 text-sm">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="option-item flex items-center gap-2">
                                <input type="text" class="option-text flex-1 px-2 py-1 border border-gray-300 rounded text-sm" placeholder="선택지 2">
                                <button class="remove-option text-red-600 hover:text-red-800 text-sm">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            questionsContainer.appendChild(questionDiv);
            attachQuestionEvents(questionDiv);
        }

        // Attach events to question elements
        function attachQuestionEvents(questionDiv) {
            // Remove question
            questionDiv.querySelector('.remove-question').onclick = function() {
                if (document.querySelectorAll('.question-item').length > 1) {
                    questionDiv.remove();
                    updateQuestionNumbers();
                } else {
                    showNotification('최소 1개의 질문이 필요합니다.', 'warning');
                }
            };
            
            // Question type change
            const typeSelect = questionDiv.querySelector('.question-type');
            const optionsContainer = questionDiv.querySelector('.options-container');
            
            typeSelect.onchange = function() {
                const needsOptions = ['MULTIPLE_CHOICE', 'CHECKBOX', 'DROPDOWN'].includes(this.value);
                optionsContainer.style.display = needsOptions ? 'block' : 'none';
            };
            
            // Add option
            questionDiv.querySelector('.add-option').onclick = function() {
                const optionsList = questionDiv.querySelector('.options-list');
                const optionCount = optionsList.children.length + 1;
                
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option-item flex items-center gap-2';
                optionDiv.innerHTML = `
                    <input type="text" class="option-text flex-1 px-2 py-1 border border-gray-300 rounded text-sm" placeholder="선택지 ${optionCount}">
                    <button class="remove-option text-red-600 hover:text-red-800 text-sm">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                optionDiv.querySelector('.remove-option').onclick = function() {
                    if (optionsList.children.length > 1) {
                        optionDiv.remove();
                    } else {
                        showNotification('최소 1개의 선택지가 필요합니다.', 'warning');
                    }
                };
                
                optionsList.appendChild(optionDiv);
            };
            
            // Remove option events for existing options
            questionDiv.querySelectorAll('.remove-option').forEach(btn => {
                btn.onclick = function() {
                    const optionsList = questionDiv.querySelector('.options-list');
                    if (optionsList.children.length > 1) {
                        btn.closest('.option-item').remove();
                    } else {
                        showNotification('최소 1개의 선택지가 필요합니다.', 'warning');
                    }
                };
            });
        }

        // Update question numbers
        function updateQuestionNumbers() {
            document.querySelectorAll('.question-item').forEach((item, index) => {
                item.querySelector('h3').textContent = `질문 ${index + 1}`;
            });
            questionCount = document.querySelectorAll('.question-item').length;
        }

        // Generate Google Form
        async function generateGoogleForm() {
            if (!isSignedIn) {
                showNotification('먼저 Google 계정으로 로그인해주세요.', 'error');
                return;
            }
            
            const title = document.getElementById('formTitle').value.trim();
            const description = document.getElementById('formDescription').value.trim();
            
            if (!title) {
                showNotification('설문지 제목을 입력해주세요.', 'error');
                return;
            }
            
            // Collect questions
            const questions = [];
            document.querySelectorAll('.question-item').forEach((item, index) => {
                const questionTitle = item.querySelector('.question-title').value.trim();
                const questionType = item.querySelector('.question-type').value;
                const isRequired = item.querySelector('.question-required').checked;
                
                if (!questionTitle) {
                    showNotification(`질문 ${index + 1}의 제목을 입력해주세요.`, 'error');
                    return;
                }
                
                const question = {
                    title: questionTitle,
                    type: questionType,
                    required: isRequired
                };
                
                // Collect options for multiple choice questions
                if (['MULTIPLE_CHOICE', 'CHECKBOX', 'DROPDOWN'].includes(questionType)) {
                    const options = [];
                    item.querySelectorAll('.option-text').forEach(optionInput => {
                        const optionText = optionInput.value.trim();
                        if (optionText) {
                            options.push({ value: optionText });
                        }
                    });
                    question.options = options;
                }
                
                questions.push(question);
            });
            
            if (questions.length === 0) {
                showNotification('최소 1개의 질문을 추가해주세요.', 'error');
                return;
            }
            
            // Show loading
            document.getElementById('loadingModal').classList.remove('hidden');
            
            try {
                // Create form
                const formResource = {
                    info: {
                        title: title,
                        description: description
                    }
                };
                
                const form = await gapi.client.forms.forms.create({
                    resource: formResource
                });
                
                const formId = form.result.formId;
                
                // Add questions to form
                const requests = questions.map((question, index) => {
                    const request = {
                        createItem: {
                            item: {
                                title: question.title,
                                questionItem: {
                                    question: {
                                        required: question.required
                                    }
                                }
                            },
                            location: {
                                index: index
                            }
                        }
                    };
                    
                    // Set question type
                    switch (question.type) {
                        case 'MULTIPLE_CHOICE':
                            request.createItem.item.questionItem.question.choiceQuestion = {
                                type: 'RADIO',
                                options: question.options || []
                            };
                            break;
                        case 'CHECKBOX':
                            request.createItem.item.questionItem.question.choiceQuestion = {
                                type: 'CHECKBOX',
                                options: question.options || []
                            };
                            break;
                        case 'DROPDOWN':
                            request.createItem.item.questionItem.question.choiceQuestion = {
                                type: 'DROP_DOWN',
                                options: question.options || []
                            };
                            break;
                        case 'SHORT_ANSWER':
                            request.createItem.item.questionItem.question.textQuestion = {
                                paragraph: false
                            };
                            break;
                        case 'PARAGRAPH':
                            request.createItem.item.questionItem.question.textQuestion = {
                                paragraph: true
                            };
                            break;
                    }
                    
                    return request;
                });
                
                if (requests.length > 0) {
                    await gapi.client.forms.forms.batchUpdate({
                        formId: formId,
                        resource: {
                            requests: requests
                        }
                    });
                }
                
                // Hide loading
                document.getElementById('loadingModal').classList.add('hidden');
                
                // Show result
                const formUrl = `https://docs.google.com/forms/d/${formId}/edit`;
                const publicUrl = `https://docs.google.com/forms/d/${formId}/viewform`;
                
                document.getElementById('formResult').innerHTML = `
                    <div class="space-y-4">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h3 class="font-semibold text-green-800 mb-2">
                                <i class="fas fa-check-circle mr-2"></i>
                                구글폼이 성공적으로 생성되었습니다!
                            </h3>
                            <p class="text-green-700 mb-3">제목: ${title}</p>
                            <div class="flex gap-2 flex-wrap">
                                <a href="${formUrl}" target="_blank" 
                                   class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200">
                                    <i class="fas fa-edit mr-2"></i>폼 편집하기
                                </a>
                                <a href="${publicUrl}" target="_blank" 
                                   class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>폼 보기
                                </a>
                                <button onclick="copyToClipboard('${publicUrl}')"
                                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition duration-200">
                                    <i class="fas fa-copy mr-2"></i>링크 복사
                                </button>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-800 mb-2">생성된 질문들:</h4>
                            <ul class="text-blue-700 space-y-1">
                                ${questions.map((q, i) => `<li>${i + 1}. ${q.title} (${getQuestionTypeLabel(q.type)}${q.required ? ', 필수' : ''})</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
                
                document.getElementById('formPreview').classList.remove('hidden');
                showNotification('구글폼이 성공적으로 생성되었습니다!', 'success');
                
                // Scroll to result
                document.getElementById('formPreview').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                document.getElementById('loadingModal').classList.add('hidden');
                console.error('폼 생성 실패:', error);
                showNotification('폼 생성에 실패했습니다: ' + (error.result?.error?.message || error.message), 'error');
            }
        }

        // Get question type label
        function getQuestionTypeLabel(type) {
            const labels = {
                'MULTIPLE_CHOICE': '객관식',
                'SHORT_ANSWER': '단답형',
                'PARAGRAPH': '장문형',
                'CHECKBOX': '체크박스',
                'DROPDOWN': '드롭다운'
            };
            return labels[type] || type;
        }

        // Copy to clipboard
        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                showNotification('링크가 클립보드에 복사되었습니다!', 'success');
            } catch (error) {
                console.error('클립보드 복사 실패:', error);
                showNotification('링크 복사에 실패했습니다.', 'error');
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Load environment variables
            const hasConfig = loadEnvironmentVariables();
            
            // Event listeners
            document.getElementById('saveConfig').onclick = saveConfiguration;
            document.getElementById('loadEnvVars').onclick = () => {
                loadEnvironmentVariables();
                showNotification('환경변수를 다시 로드했습니다.', 'info');
            };
            document.getElementById('addQuestion').onclick = addQuestion;
            document.getElementById('generateForm').onclick = generateGoogleForm;
            
            // Attach events to initial question
            attachQuestionEvents(document.querySelector('.question-item'));
            
            // Initialize Google API if config is available
            if (hasConfig) {
                initializeGapi().then(success => {
                    if (success) {
                        showNotification('Google API가 성공적으로 초기화되었습니다.', 'success');
                    }
                });
            } else {
                showNotification('Google API 설정이 필요합니다. Client ID와 API Key를 입력해주세요.', 'warning');
            }
        });
    </script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDrFiuQaqJLHTVhJKIVUC%2Fs6alkkPSMLm1oU24BYZcBOdaBQLdJWKtFqkr4SFCKldk2b1hCGNLg0ifxr6KHrL4heE%2BBaLLUA%2FLSACubgNYfjs%2BTt0HBJy8axWiyB3RtgO348PxG9Zy2SIJJryUS98Zt28ibaCp72s6CltPCKLpg1JTLrFpWWu6q5cRBAkneKfjpRVvVYmGVP9u2EzUiIGsVhjnGz3BK4X7mteabZC9H1owUjLG%2BYe8SaNmYPhUKNrKAYi%2Fe3k1Hg%2FbLLrwYNW8JO6n45sBtI%2Blv%2Bt8%2F%2BDPZTQ4g%2Fvp8exghW0fMeo8cyE0u4%2FrX9UpYxiVh%2BBW1mc4TJ1iz4Vk%2Bd4cufsUvTlNvrQOHVbKwgsMdwGKKocVhSHYccxLwMhLbAclZi37M2WzyPQPrvPUsafk7e9NVHLuJkrwu8OFnDWEXXlQRhNorqRe261o%2FfBy1t37PxWAZsTKGvCaJi1VKlMfV84LscUZt7XSs0MOD%2Fza%2FbYKogeN%2B9cn7ROLNmTlqgjr%2Bv9lW4YaCE%3D";
        window.__genspark_locale = "ko-KR";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDrFiuQaqJLHTVhJKIVUC/s6alkkPSMLm1oU24BYZcBOdaBQLdJWKtFqkr4SFCKldk2b1hCGNLg0ifxr6KHrL4heE+BaLLUA/LSACubgNYfjs+Tt0HBJy8axWiyB3RtgO348PxG9Zy2SIJJryUS98Zt28ibaCp72s6CltPCKLpg1JTLrFpWWu6q5cRBAkneKfjpRVvVYmGVP9u2EzUiIGsVhjnGz3BK4X7mteabZC9H1owUjLG+Ye8SaNmYPhUKNrKAYi/e3k1Hg/bLLrwYNW8JO6n45sBtI+lv+t8/+DPZTQ4g/vp8exghW0fMeo8cyE0u4/rX9UpYxiVh+BW1mc4TJ1iz4Vk+d4cufsUvTlNvrQOHVbKwgsMdwGKKocVhSHYccxLwMhLbAclZi37M2WzyPQPrvPUsafk7e9NVHLuJkrwu8OFnDWEXXlQRhNorqRe261o/fBy1t37PxWAZsTKGvCaJi1VKlMfV84LscUZt7XSs0MOD/za/bYKogeN+9cn7ROLNmTlqgjr+v9lW4YaCE=";
    </script>
    
    <script id="html_notice_dialog_script" src="./Google Forms Generator - Complete Version_files/notice_dialog.js"></script>
    </body></html>